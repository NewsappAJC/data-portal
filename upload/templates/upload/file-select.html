{% extends 'base.html' %}
{% load static %}

{% block resources %}
  <script type="text/javascript" src="{% static "js/file-select.js"%}"></script>
{% endblock %}

{% block content %}
<a href="/logout/"><button class="btn btn-default logout">Log out</button></a>
<div class="row">

  <div class="col-sm-3 sidebar">

    <h4>Looking for a dataset?</h4>
    <p><a href="/search/">Go to search page</a></p>

    <h4>Recent uploads</h4>
    <ul>
      {% for upload in uploads %}
        <li>
          <a href="/search/"><div>{{upload.table}}</div></a>
          <div class="timestamp">{{upload.upload_time}}</div>
          <div class="topic">Topic: {{upload.topic}}</div>
          <div><em>Uploaded by {{upload.user}}</em></div>
        </li>
      {% endfor %}
    </ul>

    <h4>Found a bug?</h4>
    <p>Contact the authors</p>
    <p>
      <a href="mailto:jonathan.cox@ajc.com">Jonathan Cox</a>
    </p>
    <p>
      <a href="mailto:jeff.ernsthausen@ajc.com">Jeff Ernsthausen</a>
    </p>

  </div><!--sidebar-->

  <div class="upload-form-holder col-sm-9">
    <div class="page-header"><h3>Upload a CSV</h3></div>

    <form enctype="multipart/form-data" class="form" id="upload-form" action="/" method="post">
    <input type="hidden" name="tempfile" id="tempfile"/>
      {% csrf_token %}
        <div class="row">
          <div class="col-sm-8">
            <div class="form-group">
              <label>{{ form.data_file.label }}</label>
              {{form.data_file}}
              <div class="errors"></div>
            </div>
          </div>
          <div class="col-sm-3">
            <div class="form-group">
              <label>{{ form.table_name.label }}</label>
              {{form.table_name}}
              <div class="errors"></div>
            </div>
          </div>
          <div style="clear:both;"></div>

          <div class="db_holder">
            <div class="col-sm-5">
              <div class="form-group">
                <label>{{ form.db_select.label }}</label>
                {{form.db_select}}
                <div class="errors"></div>
              </div>
            </div>
            <div class="col-sm-1 or">
              <h4>OR</h4>
            </div>
            <div class="col-sm-6">
              <div class="form-group">
                <label>{{ form.db_input.label }}</label>
                {{form.db_input}}
                <div class="errors"></div>
              </div>
            </div>
            <!--To give the db-holder dimensions-->
            <div style="clear:both;"></div>
          </div>

          <div class="col-sm-6">
            <div class="form-group">
              <label>{{ form.topic.label }}</label>
              {{form.topic}}
              <div class="errors"></div>
            </div>
          </div>
          <div class="col-sm-6">
            <div class="form-group">
              <label>{{ form.source.label }}</label>
              {{form.source}}
              <div class="errors"></div>
            </div>
          </div>

          <div class="col-sm-4">
            <div class="form-group">
              <label>{{ form.press_contact.label }}</label>
              {{form.press_contact}}
              <div class="errors"></div>
            </div>
          </div>
          <div class="col-sm-4">
            <div class="form-group">
              <label>{{ form.press_contact_number.label }}</label>
              {{form.press_contact_number}}
              <div class="errors"></div>
            </div>
          </div>

          <div class="col-sm-4">
            <div class="form-group">
              <label>{{ form.press_contact_email.label }}</label>
              {{form.press_contact_email}}
              <div class="errors"></div>
            </div>
          </div>

        </div>

      </form>

      <div id="non-field-errors" class="errors"></div>

      <div>
        <button id="file-submit" data-loading-text="Uploading..." class="btn btn-primary">Submit</button>
      </div>

  </div><!--upload-form-holder-->

{% if messages %}
<div class="messages">
  {% for message in messages %}
    <p>{{ message }}</p>
  {% endfor %}
</div>
{% endif %}

  <script src="{% static "js/tmpResults.js"%}"></script>

{% endblock %}
